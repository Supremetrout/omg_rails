
## Company Unlocks

To support unit swapping, we need to change squads' `available_unit` attribute to point to the new `available_unit` for the new unit. 
This requires differentiating `AvailableUnit` by type so that we only use `BaseAvailableUnit`, representing the primary purchasable
version of the unit (as opposed to free or other special cases), to swap to.

Since now it's possible to have multiple `AvailableUnits` for a `Company` and `Unit`, company squad updates need to pass 
`available_unit_id` as the identifier of what was purchased as `unit_id` will not be sufficiently specific.

### Unit Modifications
There are certain subclasses of `RestrictionUnit` that when unlocked by a company unlock purchase, will be applied against the `BaseAvailableUnit` of the associated unit.

The fields affected are enumerated in `RestrictionUnit::MODIFY_FIELDS`.

The priority of the record will determine where in the order it is applied, from 1 to 100, with 1 applied first and 100 last.

Cases:
* `ModifiedReplaceUnit` - any non-nil fields on this record will replace that of the `BaseAvailableUnit`
* `ModifiedAddUnit` - any non-nil fields on this record will be added to that of the `BaseAvailableUnit`. The value can be negative.

## Transport
1. New model `TransportAllowedUnit` represents one to many of transport units to units they are permitted to transport
2. New model `TransportedSquad` represents a specific relationship between a transport `Squad` and an embarked `Squad`. Currently this should be 1 level of transport only.
3. `Units` capable of transport have two fields for their capacities: `transport_squad_slots` and `transport_model_slots`. Squads of these units must keep their embarked squads at or below those squad and model limits.
4. `Units` capable of being embarked have a new field `model_count` representing how many model slots the unit takes up
5. Squads have a new field `total_model_count` representing the total model slots it takes up, including upgrades.
6. Squads have a new field `uuid` of a unique string id generated by the front end. This is used to identify transport relationships between squads when they exist only in the FE and haven't been persisted (given an id by the db). Since this is the only reliable id we have in the FE for new squads we use `uuid` for all transport related operations.

## Offmaps 
Follow the Unit model, where

* `offmap` describes the base offmap entity with no cost
* `restriction_offmap` describes how a base `offmap` is made available to different restrictions. Costs included
* `available_offmap` describes what `offmaps` are available to a company, established from `restriction_offmap`

## Callin Modifiers
`CallinModifier` defines the modifier value, and how the modifier is applied (currently multiplicative only)

`CallinModifierRequiredUnit` defines certain units that the platoon must have one of in order to qualify for the callin modifier
* If none exist for the `CallinModifier`, signals that any mix of the allowed units are valid

`CallinModifierAllowedUnit` defines all units that may be in the platoon and still qualify for the callin modifier. 
* If there are non-zero `CallinModifierAllowedUnit`s, only those units may exist in the platoon and qualify
* If there are zero `CallinModifierAllowedUnit`s, any unit may exist in the platoon and qualify